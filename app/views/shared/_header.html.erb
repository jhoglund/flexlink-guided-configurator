<!-- Header/Navigation -->
<header class="header" data-controller="header" id="main-header">
  <div class="header-container">
    <div class="header-content">
      <!-- Logo Section -->
      <div class="header-logo">
        <%= image_tag "flexlink-logo.svg", class: "logo-icon", alt: "FlexLink" %>
      </div>
      
      <!-- Navigation Section -->
      <nav class="header-navigation">
        <%= link_to "Home", root_path, class: "nav-link #{current_page?(root_path) ? 'active' : ''}" %>
        
        <!-- Industries Dropdown -->
        <div class="nav-dropdown">
          <button class="dropdown-trigger" 
                  data-header-target="trigger"
                  data-action="click->header#toggle"
                  aria-expanded="false" 
                  aria-haspopup="true">
            Industries
            <i class="fas fa-chevron-down"></i>
          </button>
          <div class="dropdown-menu industries-dropdown" data-header-target="dropdown">
            <div class="dropdown-content">
              <a href="#" class="dropdown-item" tabindex="0" data-action="keydown->header#handleKeydown">Automotive</a>
              <a href="#" class="dropdown-item" tabindex="0" data-action="keydown->header#handleKeydown">Batteries</a>
              <a href="#" class="dropdown-item" tabindex="0" data-action="keydown->header#handleKeydown">Dairy</a>
              <a href="#" class="dropdown-item" tabindex="0" data-action="keydown->header#handleKeydown">E-Commerce Solutions</a>
              <a href="#" class="dropdown-item" tabindex="0" data-action="keydown->header#handleKeydown">Electronics</a>
              <a href="#" class="dropdown-item" tabindex="0" data-action="keydown->header#handleKeydown">Food</a>
              <a href="#" class="dropdown-item" tabindex="0" data-action="keydown->header#handleKeydown">Lab Automation</a>
              <a href="#" class="dropdown-item" tabindex="0" data-action="keydown->header#handleKeydown">Optical</a>
              <a href="#" class="dropdown-item" tabindex="0" data-action="keydown->header#handleKeydown">Personal Care</a>
              <a href="#" class="dropdown-item" tabindex="0" data-action="keydown->header#handleKeydown">Pharma & Healthcare</a>
              <a href="#" class="dropdown-item" tabindex="0" data-action="keydown->header#handleKeydown">Tissue & Hygiene</a>
              <a href="#" class="dropdown-item" tabindex="0" data-action="keydown->header#handleKeydown">Tobacco</a>
            </div>
          </div>
        </div>
        
        <a href="#" class="nav-link">Build your own system</a>
        <a href="#" class="nav-link">FAQ</a>
        <a href="#" class="nav-link">Contact us</a>
      </nav>
      
      <!-- Utility Section -->
      <div class="header-utility">
        <!-- Search Field -->
        <div class="search-container">
          <input type="text" class="search-input" placeholder="Search..." aria-label="Search">
          <button class="search-btn" aria-label="Search">
            <i class="fas fa-search"></i>
          </button>
        </div>
        
        <!-- Language Selector Dropdown -->
        <div class="language-dropdown">
          <button class="dropdown-trigger" 
                  data-header-target="trigger"
                  data-action="click->header#toggle"
                  aria-expanded="false" 
                  aria-haspopup="true">
            <span>Eng</span>
            <i class="fas fa-chevron-down"></i>
          </button>
          <div class="dropdown-menu dropdown-right" data-header-target="dropdown">
            <div class="dropdown-content">
              <a href="#" class="dropdown-item" data-lang="en" tabindex="0" data-action="keydown->header#handleKeydown">English</a>
              <a href="#" class="dropdown-item" data-lang="de" tabindex="0" data-action="keydown->header#handleKeydown">Deutsch</a>
              <a href="#" class="dropdown-item" data-lang="fr" tabindex="0" data-action="keydown->header#handleKeydown">FranÃ§ais</a>
              <a href="#" class="dropdown-item" data-lang="it" tabindex="0" data-action="keydown->header#handleKeydown">Italiano</a>
              <a href="#" class="dropdown-item" data-lang="es" tabindex="0" data-action="keydown->header#handleKeydown">EspaÃ±ol</a>
              <a href="#" class="dropdown-item" data-lang="pt" tabindex="0" data-action="keydown->header#handleKeydown">Portuguese</a>
              <a href="#" class="dropdown-item" data-lang="pl" tabindex="0" data-action="keydown->header#handleKeydown">Polski</a>
              <a href="#" class="dropdown-item" data-lang="zh" tabindex="0" data-action="keydown->header#handleKeydown">ç®€ä½“ä¸­æ–‡</a>
              <a href="#" class="dropdown-item" data-lang="ja" tabindex="0" data-action="keydown->header#handleKeydown">æ—¥æœ¬èªž</a>
            </div>
          </div>
        </div>
        
        <!-- Utility Icons -->
        <div class="utility-icons">
          <button class="utility-btn" aria-label="User Profile">
            <i class="fas fa-user"></i>
          </button>
          <button class="utility-btn cart-btn" aria-label="Shopping Cart">
            <i class="fas fa-shopping-cart"></i>
            <span class="cart-badge">2</span>
          </button>
        </div>
        
        <!-- Hamburger Menu Button -->
        <button class="hamburger-menu" aria-label="Toggle navigation menu">
          <div class="hamburger-icon"></div>
        </button>
      </div>
    </div>
  </div>
</header>

<!-- Mobile Navigation Overlay -->
<div class="mobile-nav-overlay" data-header-target="mobileNav">
  <div class="mobile-nav-header">
    <button class="mobile-nav-close" data-action="click->header#closeMobileNav" aria-label="Close navigation menu">
      âœ•
    </button>
  </div>
  
  <div class="mobile-nav-content">
    <a href="<%= root_path %>" class="mobile-nav-item <%= current_page?(root_path) ? 'active' : '' %>">
      Home
    </a>
    
    <div class="mobile-nav-item">
      Industries
      <i class="fas fa-chevron-right chevron"></i>
    </div>
    
    <a href="#" class="mobile-nav-item">
      Build your own system
    </a>
    
    <a href="#" class="mobile-nav-item">
      FAQ
    </a>
    
    <a href="#" class="mobile-nav-item">
      Contact us
    </a>
  </div>
  
  <div class="mobile-utility">
    <a href="#" class="mobile-utility-item" aria-label="Search">
      <i class="fas fa-search"></i>
      <span>Search</span>
    </a>
    
    <a href="#" class="mobile-utility-item" aria-label="User Profile">
      <i class="fas fa-user"></i>
      <span>Profile</span>
    </a>
    
    <a href="#" class="mobile-utility-item" aria-label="Shopping Cart">
      <div style="position: relative;">
        <i class="fas fa-shopping-cart"></i>
        <span class="cart-badge">2</span>
      </div>
      <span>Cart</span>
    </a>
  </div>
</div>

<script>
  // Debug: Check if JavaScript is loading in header
  console.log('ðŸŽ¯ Header script loaded');
  
  // Simple dropdown functionality test
  document.addEventListener('DOMContentLoaded', function() {
    console.log('ðŸŽ¯ DOM Content Loaded in header');
    
    // Mobile navigation elements
    const hamburgerBtn = document.querySelector('.hamburger-menu');
    const mobileNav = document.querySelector('.mobile-nav-overlay');
    const closeBtn = document.querySelector('.mobile-nav-close');
    
    // Test if we can find the mobile navigation elements
    console.log('ðŸŽ¯ Hamburger button found:', !!hamburgerBtn);
    console.log('ðŸŽ¯ Mobile nav overlay found:', !!mobileNav);
    console.log('ðŸŽ¯ Close button found:', !!closeBtn);
    
    // Mobile navigation toggle
    if (hamburgerBtn && mobileNav) {
      hamburgerBtn.addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        console.log('ðŸŽ¯ Hamburger menu clicked!');
        
        // Toggle mobile navigation
        mobileNav.classList.add('show');
        hamburgerBtn.classList.add('open');
        document.body.style.overflow = 'hidden'; // Prevent body scroll
        console.log('ðŸŽ¯ Mobile navigation opened');
      });
    }
    
    // Close mobile navigation
    if (closeBtn && mobileNav && hamburgerBtn) {
      closeBtn.addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        console.log('ðŸŽ¯ Close button clicked!');
        
        // Close mobile navigation
        mobileNav.classList.remove('show');
        hamburgerBtn.classList.remove('open');
        document.body.style.overflow = ''; // Restore body scroll
        console.log('ðŸŽ¯ Mobile navigation closed');
      });
    }
    
    // Close mobile navigation when clicking outside
    if (mobileNav) {
      mobileNav.addEventListener('click', function(e) {
        if (e.target === mobileNav) {
          console.log('ðŸŽ¯ Clicked outside mobile nav, closing...');
          mobileNav.classList.remove('show');
          hamburgerBtn.classList.remove('open');
          document.body.style.overflow = '';
        }
      });
    }
    
    // Test if we can find the dropdown elements
    const industriesBtn = document.querySelector('.nav-dropdown .dropdown-trigger');
    const languageBtn = document.querySelector('.language-dropdown .dropdown-trigger');
    
    console.log('ðŸŽ¯ Industries button found:', !!industriesBtn);
    console.log('ðŸŽ¯ Language button found:', !!languageBtn);
    
    if (industriesBtn) {
      industriesBtn.addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        console.log('ðŸŽ¯ Industries button clicked!');
        
        const dropdown = this.closest('.nav-dropdown').querySelector('.dropdown-menu');
        const isOpen = dropdown.classList.contains('show');
        
        // Close all other dropdowns first
        document.querySelectorAll('.dropdown-menu').forEach(d => d.classList.remove('show'));
        document.querySelectorAll('[aria-expanded]').forEach(el => el.setAttribute('aria-expanded', 'false'));
        
        if (!isOpen) {
          dropdown.classList.add('show');
          this.setAttribute('aria-expanded', 'true');
          console.log('ðŸŽ¯ Industries dropdown opened');
        } else {
          dropdown.classList.remove('show');
          this.setAttribute('aria-expanded', 'false');
          console.log('ðŸŽ¯ Industries dropdown closed');
        }
      });
    }
    
    if (languageBtn) {
      languageBtn.addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        console.log('ðŸŽ¯ Language button clicked!');
        
        const dropdown = this.closest('.language-dropdown').querySelector('.dropdown-menu');
        const isOpen = dropdown.classList.contains('show');
        
        // Close all other dropdowns first
        document.querySelectorAll('.dropdown-menu').forEach(d => d.classList.remove('show'));
        document.querySelectorAll('[aria-expanded]').forEach(el => el.setAttribute('aria-expanded', 'false'));
        
        if (!isOpen) {
          dropdown.classList.add('show');
          this.setAttribute('aria-expanded', 'true');
          console.log('ðŸŽ¯ Language dropdown opened');
        } else {
          dropdown.classList.remove('show');
          this.setAttribute('aria-expanded', 'false');
          console.log('ðŸŽ¯ Language dropdown closed');
        }
      });
    }
    
    // Close dropdowns when clicking outside
    document.addEventListener('click', function(e) {
      if (!e.target.closest('.nav-dropdown, .language-dropdown')) {
        document.querySelectorAll('.dropdown-menu').forEach(d => d.classList.remove('show'));
        document.querySelectorAll('[aria-expanded]').forEach(el => el.setAttribute('aria-expanded', 'false'));
        console.log('ðŸŽ¯ Closed all dropdowns (clicked outside)');
      }
    });
  });
</script>